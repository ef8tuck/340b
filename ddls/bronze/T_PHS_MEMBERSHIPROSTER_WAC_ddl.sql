CREATE TABLE IF NOT EXISTS $$unity_catalog_name.$$schema_name.$$delta_table_name (
CUST_ACCT_ID string  ,
CUST_NAME string  ,
340B_ID string  ,
PVP_PARTICIPANT_ID string  ,
PVP_PARTICIPATION_FLAG string  ,
PVP_MEMBER_NAME string  ,
PVP_EFFECTIVE_DATE string  ,
PVP_EXPIRATION_DATE string  ,
STORE_NUM string  ,
DEA_FAMILY string  ,
MARKETING_CAMPAIGN string  ,
HOME_DC_ID string  ,
DEA_NUM string  ,
HIN_BASE_CD string  ,
HIN_DEPT_CD string  ,
HIN_LOCATION_CD string  ,
HIN_NUM string  ,
ATTENTION_NAME_DELY string  ,
ADDR_LINE_1_DELY string  ,
ADDR_LINE_2_DELY string  ,
CITY_NAME_DELY string  ,
STATE_CD_DELY string  ,
ZIP_CD_DELY string  ,
ATTENTION_NAME_INV string  ,
ADDR_LINE_1_INV string  ,
ADDR_LINE_2_INV string  ,
CITY_NAME_INV string  ,
STATE_CD_INV string  ,
ZIP_CD_INV string  ,
CUST_CHAIN_ID string  ,
CUST_CHAIN_NAME string  ,
NATIONAL_GROUP_CD string  ,
NATIONAL_GROUP_NAME string  ,
NATIONAL_SUB_GROUP_CD string  ,
NATIONAL_SUB_GROUP_NAME string  ,
REGION_NUM string  ,
REGION_NAME string  ,
DISTRICT_NUM string  ,
DISTRICT_NAME string  ,
RX_BILL_PLAN_CD string  ,
BUSINESS_TYPE_CD string  ,
DISTRIBUTION_CHANNEL string  ,
SALES_TERRITORY_ID string  ,
PRIMARY_CUST_ID string  ,
3RD_PARTY_VENDOR string  ,
SECONDARY_VENDOR string  ,
OTHER_VENDORS string  ,
ACCOUNT_CLASSIFICATION string  ,
ACCOUNT_CLASSIFICATION_DESCRIPTION string  ,
IS_ACTIVE STRING DEFAULT 'Y' COMMENT 'Indicates if the record is active, default is Y',
  _rescued_data STRING COMMENT 'Rescued Data',
  ADF_RUN_ID STRING COMMENT 'ID for specific pipeline run loaded from landing. This run_id gets generated when the records gets loaded from source to landing',
  ADF_JOB_ID STRING COMMENT 'ID of the trigger that invokes the pipeline. This job_id gets generated when the records gets loaded from source to landing',
  RECORD_LOAD_TIME TIMESTAMP DEFAULT current_timestamp COMMENT 'This is the default generated column using current timestamp when the record is loaded in the table',
  INPUT_FILE_NAME STRING COMMENT 'This is extracted from the input file name of source',
  DATABRICKS_RUN_ID STRING COMMENT 'Run ID of the Databricks job run. This gets generated from the bronze notebook run',
  DATABRICKS_JOB_ID STRING COMMENT 'Job ID of the Databricks job run. This gets generated from the bronze notebook run',
  DATE_PART DATE GENERATED ALWAYS AS (DATE(RECORD_LOAD_TIME)) COMMENT 'This is autogenerated from date part of the RECORD_LOAD_TIME column',
  HOUR_PART INT GENERATED ALWAYS AS (HOUR(RECORD_LOAD_TIME)) COMMENT 'This is autogenerated from hour part of the RECORD_LOAD_TIME column'
) USING DELTA PARTITIONED BY (DATE_PART, HOUR_PART) LOCATION '$$delta_table_location'
TBLPROPERTIES (
  'delta.feature.allowColumnDefaults' = 'supported',
  'delta.feature.appendOnly' = 'supported',
  'delta.feature.invariants' = 'supported',
  'delta.minReaderVersion' = '1',
  'delta.minWriterVersion' = '7',
  'spark.sql.files.ignoreMissingFiles'=true
);
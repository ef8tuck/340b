CREATE TABLE IF NOT EXISTS $$unity_catalog_name.$$schema_name.$$delta_table_name (
CUST_ACCT_ID string,
CUST_NUM string,
CUST_BUS_TYP_CD string,
SLS_TERR_ID string,
PRI_FILL_DC_ID string,
NATL_ACCT_ID string,
CUST_ACCT_NAM string,
HIN_NUM string,
PRI_ACCT_IND  string,
DLVRY_RTE_NUM string,
DLVRY_RTE_STOP_NUM string,
VRITE_BUS_TYP_CD string,
VRITE_REBT_IND string,
ACCT_DLVRY_ADDR string,
ACCT_DLVRY_CTY_NAM string,
ACCT_DLVRY_ST_ABRV string,
ACCT_DLVRY_ZIP string,
ACCT_DLVRY_ZIP_SFX string,
HOME_DC_ID string,
HOME_DC_DSCR string,
SLSPRSN_ID string,
NATL_ACCT_DSCR string,
PRI_FILL_DC_DSCR string,
NABP_NUM string,
DEA_NUM string,
VRITE_CUST_IND string,
CUST_CHN_ID string,
CUST_STOR_NUM string,
ACCT_DLVRY_AREA_CD string,
ACCT_DLVRY_PH_NUM string,
ACTIVE_CUST_IND string,
XTRCT_DT string,
CR_STAT_CD string,
DEA_NUM_EXPIR_DT string,
ST_PHARM_LCNS_NUM string,
MDCD_ST_ABRV string,
DLVRY_ATTN_NAM string,
CR_LMT_DLLR_AMT integer,
PMT_TRMS_CD string,
CUR_DUE_DLLR_AMT decimal(38,18),
TOT_DUE_DLLR_AMT decimal(38,18),
MS_SCHM_ID string,
CUST_RGN_NUM string,
CUST_DSTRCT_NUM string,
CUST_CMAX_IND string,
CUST_OMNI_IND string,
CUST_SEL_GNRC_IND string,
MCK_ACCT_VNDR_CD string,
NATL_GRP_CD string,
NATL_SUB_GRP_CD string,
ACCT_SVC_ELIG_BEG_DT timestamp,
ACCT_SVC_ELIG_END_DT timestamp,
ACCT_CHN_ID string,
ALT_SRC_ID string,
CUST_ACCT_HIN_BASE_CD string,
CUST_ACCT_HIN_LOC_CD string,
CUST_ACCT_HIN_DEPT_CD string,
ORDFLTR_CUSTGRP_ID string,
ORDR_ITEM_FLTR_CD string,
DLVRY_DOC_IND string,
CUST_ASGN_MCK_IND string,
INVC_FMT_CD string,
INVC_SUM_TYP_CD string,
MCK_CO_CD string,
CUST_LOC_ID string,
ACCT_LOC_ID string,
ACCT_STOR_NUM string,
RETL_ACCT_MNGR_ID string,
RETL_ACCT_SVC_REP_ID string,
NPI_NUM string,
SITE_ID string,
PRI_SITE_IND string,
SRC_ID_MULT string,
CUST_TYPE_BUS string,
ITEM_CNTRL1 string,
ITEM_CNTRL2 string,
ITEM_CNTRL3 string,
ITEM_CNTRL4 string,
ITEM_CNTRL5 string,
ITEM_CNTRL6 string,
ITEM_CNTRL7 string,
ITEM_CNTRL8 string,
DELY_FEE string,
AR_PPD string,
CUST_SVC_BEG2 string,
CUST_SVC_END3 string,
DEA_CRN_EXP_DT string,
DEA_CHEM_REG_NO string,
NEW_MAIL_NAME string,
FAX_CUST_AREA string,
ADR_CUST_DELY2 string,
ITEM_PVT_LBL string,
FILLER string,
SRC_ID_MULT1 string,
CUST_GRP string,
DEA_NUM_SH string,
IS_ACTIVE STRING DEFAULT 'Y' COMMENT 'Indicates if the record is active, default is Y',
  _rescued_data STRING COMMENT 'Rescued Data',
  ADF_RUN_ID STRING COMMENT 'ID for specific pipeline run loaded from landing. This run_id gets generated when the records gets loaded from source to landing',
  ADF_JOB_ID STRING COMMENT 'ID of the trigger that invokes the pipeline. This job_id gets generated when the records gets loaded from source to landing',
  RECORD_LOAD_TIME TIMESTAMP DEFAULT current_timestamp COMMENT 'This is the default generated column using current timestamp when the record is loaded in the table',
  INPUT_FILE_NAME STRING COMMENT 'This is extracted from the input file name of source',
  DATABRICKS_RUN_ID STRING COMMENT 'Run ID of the Databricks job run. This gets generated from the bronze notebook run',
  DATABRICKS_JOB_ID STRING COMMENT 'Job ID of the Databricks job run. This gets generated from the bronze notebook run',
  DATE_PART DATE GENERATED ALWAYS AS (DATE(RECORD_LOAD_TIME)) COMMENT 'This is autogenerated from date part of the RECORD_LOAD_TIME column',
  HOUR_PART INT GENERATED ALWAYS AS (HOUR(RECORD_LOAD_TIME)) COMMENT 'This is autogenerated from hour part of the RECORD_LOAD_TIME column'
) USING DELTA PARTITIONED BY (DATE_PART, HOUR_PART) LOCATION '$$delta_table_location'
TBLPROPERTIES (
  'delta.feature.allowColumnDefaults' = 'supported',
  'delta.feature.appendOnly' = 'supported',
  'delta.feature.invariants' = 'supported',
  'delta.minReaderVersion' = '1',
  'delta.minWriterVersion' = '7',
  'spark.sql.files.ignoreMissingFiles'=true
);
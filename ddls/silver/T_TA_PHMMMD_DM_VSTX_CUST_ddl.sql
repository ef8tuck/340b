CREATE TABLE IF NOT EXISTS $$unity_catalog_name.$$schema_name.$$delta_table_name (
KUNNR_CUST string, 
CUST_ACCT_ID string,
XFD_KU_CK_DGT decimal(38,18),
XFD_KU_BILLING_BLK string,
XFD_KU_AUTH string,
XFD_KU_TELEBOX string,
XFD_KU_INDST_CD_4 string,
XFD_KU_INDST_CD_3 string,
XFD_KU_PBC_REQR string,
XFD_KU_DEA_WARN decimal(38,18),
XFD_KU_DEA_FAMILY string,
XFD_KU_ORIG_DC string,
XFD_KU_CO_IND string,
XFD_KU_ASN_HIER string,
XFD_KU_ASN_FLG_IND string,
XFD_KU_COND_GRP_1 string,
XFD_KU_VAT_REG_NO string,
XFD_KU_PSTNG_BLK string,
XFD_KU_ORD_BLK string,
XFD_KU_LOC_NO_2 decimal(38,18),
XFD_KU_LOC_NO_1 decimal(38,18),
XFD_KU_INDST string,
XFD_KU_DEL_BLK string,
XFD_KU_340B_ID string,
XFD_KU_REGLTORY_DC string,
XFD_KU_PREPAY_ID string,
XFD_KU_PLNOGRM_SIGNAGE string,
XFD_KU_PLNOGRM_CD string,
XFD_KU_INV_REF_CK string,
XFD_KU_PED_REF_TYP string,
XFD_KU_PED_ENA string,
XFD_KU_RTN_PRTOUT string,
MCK_KU_VRITE string,
XFD_KU_DLVRY_BLK string,
XFD_KU_CUST_CLS string,
XFD_KU_ACCT_GRP string,
XFD_KU_CORP_GRP string,
XFD_KU_ATRB_10 string,
XFD_KU_ATRB_1 string,
XFD_KU_ATRB_2 string,
XFD_KU_ATRB_7 string,
XFD_KU_ATRB_3 string,
XFD_KU_INDST_CD_2 string,
XFD_KU_TRNSPORTZON string,
XFD_KU_INDST_CD_1 string,
XFD_KU_EXPR_STN string,
MCK_KU_TERM_RSN string,
MCK_KU_RPTTYP string,
MCK_KU_INVDISCD string,
MCK_KU_SHPLBLTYP string,
MCK_KU_VNDR_TYP string,
MCK_KU_ACTV_DT timestamp,
MCK_KU_INV_DT_EXCL string,
MCK_KU_EQUI_SERV_DT timestamp,
MCK_KU_ITEM_STK_CONF string,
MCK_KU_CONF_TYP string,
MCK_KU_LATEPMT decimal(38,18),
MCK_KU_RX_NONRSLTX decimal(38,18),
MCK_KU_OTC_RSLTX decimal(38,18),
MCK_KU_OTC_NONRSLTX decimal(38,18),
MCK_KU_EXITDATA string,
MCK_KU_HIN_LOC string,
MCK_KU_HIN_DEPT string,
MCK_KU_DOC_NUM string,
MCK_KU_SITEID string,
MCK_KU_EXCLSERVCHRG string,
MCK_KU_PRI_SITEID string,
MCK_KU_DUNLTR string,
MCK_KU_STMT_FREQ string,
MCK_KU_CONSOL_TYP string,
MCK_KU_OSDTXT string,
MCK_KU_CORPCONS string,
MCK_KU_LIMORD decimal(38,18),
MCK_KU_CRD_LIMTOT decimal(38,18),
MCK_KU_TOTESPLIT string,
MCK_KU_DEA_ELIG string,
MCK_KU_WEB_VRITE string,
MCK_KU_ORD_FLTR_CD string,
MCK_KU_ITEM_FLTR_CD string,
MCK_KU_RX_SUB_ADJ2 string,
MCK_KU_RX_SUB_ADJ1 string,
MCK_KU_ERLY_RTE string,
MCK_KU_RX_SUB_ADJ0 string,
MCK_KU_EOE_LAST_QTY string,
MCK_KU_ALT_SRC string,
MCK_KU_SAM string,
MCK_KU_MULTI_SRC string,
MCK_KU_INIT_LOAD timestamp,
MCK_KU_PROMO_END_RSN string,
XFD_KU_TELETEX_1 string,
MCK_KU_MKUP1 decimal(38,18),
MCK_KU_ESTABBY string,
MCK_KU_PRC_TYP string,
MCK_KU_RPTLEADGRP string,
MCK_KU_RPTLEADNAM string,
MCK_KU_MEMNETWKCD string,
MCK_KU_RX_SUB_ADJ5 string,
MCK_KU_MEDST string,
MCK_KU_RX_SUB_ADJ3 string,
MCK_KU_OTCUPD string,
MCK_KU_BIWK string,
MCK_KU_LBLSTK string,
MCK_KU_STORELBL string,
MCK_KU_COST_CD0 string,
MCK_KU_COST_CD6 string,
MCK_KU_COST_CD9 string,
MCK_KU_COST_CD7 string,
XFD_KU_VNDR string,
MCK_KU_COST_CD8 string,
MCK_KU_STAT_CUST_FEP string,
MCK_KU_OTC_SUB_ADJ2 string,
MCK_KU_RX_SUB_ADJ6 string,
MCK_KU_SECR_TCH_TONE string,
MCK_KU_RX_SUB_ADJ7 string,
MCK_KU_CRREQ_CUST string,
MCK_KU_RX_SUB_ADJ8 string,
MCK_KU_PVT_LBL string,
MCK_KU_RX_SUB_ADJ9 string,
MCK_KU_OTC_RTL_DT_CD string,
MCK_KU_RX_SUB_CHAR0 string,
MCK_KU_RX_RTL_DT_CD string,
MCK_KU_RX_SUB_CHAR1 string,
MCK_KU_OTC_RTL_PLN_PCT1 decimal(38,18),
MCK_KU_RX_SUB_CHAR2 string,
MCK_KU_RX_RTL_PLN_PCT1 decimal(38,18),
MCK_KU_RX_SUB_CHAR3 string,
MCK_KU_ALPHA_SORT string,
MCK_KU_RX_SUB_CHAR4 string,
MCK_KU_LIMTOT decimal(38,18),
MCK_KU_RX_SUB_CHAR5 string,
MCK_KU_RX_SUB_CHAR6 string,
MCK_KU_RX_SUB_CHAR7 string,
MCK_KU_COST_CD1 string,
MCK_KU_RX_SUB_CHAR8 string,
MCK_KU_COST_CD2 string,
MCK_KU_RX_SUB_CHAR9 string,
MCK_KU_COST_CD3 string,
MCK_KU_OTC_SUB_ADJ0 string,
MCK_KU_COST_CD4 string,
MCK_KU_PRC_OVR_GRP string,
MCK_KU_PRC_OVR_MTH string,
MCK_KU_PRC_OVR_PCT1 decimal(38,18),
MCK_KU_VKORG string,
MCK_KU_OTC_SUB_ADJ1 string,
XFD_KU_ATRB_8_1 string,
MCK_KU_COST_CD5 string,
MCK_KU_RX_RTL_FMT_CD string,
MCK_KU_OTC_SUB_CHAR0 string,
MCK_KU_OTC_SUB_CHAR1 string,
MCK_KU_RX_SUB_ADJ4 string,
MCK_KU_OTC_SUB_CHAR2 string,
MCK_KU_SPART string,
MCK_KU_SUB_ADJ6 string,
MCK_KU_OTC_SUB_ADJ9 string,
MCK_KU_SUB_CHAR string,
MCK_KU_CUST_PRC_PLN_SPCL_P string,
MCK_KU_CUST_PRC_PLN_SPCL string,
XFD_KU_ALTPAYER string,
MCK_KU_CR_STAT string,
XFD_KU_ATRB_5_1 string,
MCK_KU_PROFL_ITEM string,
XFD_KU_ATRB_4_1 string,
MCK_KU_DEPT_LGTH decimal(38,18),
XFD_KU_ATRB_6_1 string,
MCK_KU_DEPT_FMT string,
MCK_KU_SUB_FLD decimal(38,18),
MCK_KU_ITEM_LGTH decimal(38,18),
MCK_KU_SUB_ADJ string,
MCK_KU_ITEM_FMT string,
MCK_KU_RGN_LGTH decimal(38,18),
MCK_KU_OTC_SUB_ADJ7 string,
MCK_KU_RGN_FMT string,
MCK_KU_OTC_SUB_ADJ8 string,
MCK_KU_ITEM_INPUT1 string,
MCK_KU_OTC_SUB_CHAR4 string,
MCK_KU_OTC_SUB_ADJ6 string,
MCK_KU_OTC_SUB_CHAR3 string,
MCK_KU_OTC_SUB_ADJ5 string,
MCK_KU_CR_MSG string,
MCK_KU_OTC_SUB_ADJ4 string,
MCK_KU_OTC_SUB_CHAR5 string,
MCK_KU_OTC_SUB_ADJ3 string,
MCK_KU_DEPT_INV1 string,
MCK_KU_PRC_STKR_IND string,
MCK_KU_DEPT_INV2 string,
MCK_KU_ITEM_INPUT2 string,
MCK_KU_CUST_INPUT1 string,
MCK_KU_CUST_INPUT2 string,
MCK_KU_ITEM_INV1 string,
MCK_KU_ITEM_INV2 string,
MCK_KU_MCK_DEPT string,
MCK_KU_CUST_DEPT string,
MCK_KU_PREPYMT decimal(38,18),
MCK_KU_CUST_LGTH decimal(38,18),
MCK_KU_DSTRCT_LGTH decimal(38,18),
MCK_KU_CUST_FMT string,
MCK_KU_DSTRCT_FMT string,
MCK_KU_PROMOEND timestamp,
MCK_KU_RPT_GRP_SLS_TAX string,
MCK_KU_SUB_ADJ5 string,
MCK_KU_CNFRM_SEQ string,
MCK_KU_SUB_ADJ0 string,
MCK_KU_CNFRM_RPT string,
MCK_KU_SUB_ADJ8 string,
MCK_KU_SUB_ADJ7 string,
MCK_KU_SUB_ADJ1 string,
MCK_KU_SUB_ADJ4 string,
MCK_KU_SUB_ADJ3 string,
MCK_KU_SUB_ADJ2 string,
MCK_KU_SPCLS string,
MCK_KU_OTC_SUB_CHAR8 string,
MCK_KU_OTC_SUB_CHAR9 string,
MCK_KU_CR_TERMS string,
MCK_KU_DS_XCPT_RX decimal(38,18),
MCK_KU_CUST_DEPT_DESC string,
MCK_KU_DS_XCPT_OTC decimal(38,18),
MCK_KU_MKUP decimal(38,18),
MCK_KU_SVC_PROG_TYP string,
MCK_KU_PRC_OVR_PCT decimal(38,18),
MCK_KU_PICK_CONSOL string,
MCK_KU_ADDBILL_THRESH string,
MCK_KU_PROMO_MGR_RTL string,
MCK_KU_PROCESS_GRP_CD string,
MCK_KU_WRKLD_BAL_EXCL string,
MCK_KU_OTC_RTL_FMT_CD string,
MCK_KU_FMT_PRC_LBL string,
MCK_KU_DLOC_ST_CD string,
MCK_KU_PREFD_CUST string,
MCK_KU_DLOC_REGN string,
MCK_KU_DS_ELIG string,
MCK_KU_RTL_RX_LBL_CONST2 string,
MCK_KU_INV_SPLIT_ORD string,
MCK_KU_DLOC_AREA string,
MCK_KU_OTC_SUB_CHAR6 string,
MCK_KU_DLOC_ABBR string,
MCK_KU_OTC_SUB_CHAR7 string,
MCK_KU_ST_PHARM string,
MCK_KU_HIN_BASE string,
MCK_KU_NCPDP string,
MCK_KU_RTL_RX_LBL_CONST1 string,
MCK_KU_DEA_SEC_EXPIR timestamp,
MCK_KU_PRI_ACCT string,
MCK_KU_PRICING_LEAD string,
MCK_KU_RETL_LEAD string,
MCK_KU_ST_PHARM_EXPIR timestamp,
MCK_KU_MKTG_OPTN string,
MCK_KU_XREF_LEAD string,
MCK_KU_RPT_LEAD string,
MCK_KU_SHIP_FEE_CD_REG string,
MCK_KU_SHIP_FEE_CD_OVRNITE string,
MCK_KU_PO_REQR string,
MCK_KU_OTC_FEE_CD string,
MCK_KU_OTC_RTL_PLN_PCT decimal(38,18),
MCK_KU_RX_FEE_CD string,
MCK_KU_RX_RTL_PLN_PCT decimal(38,18),
XFD_KU_KATR4 string,
XFD_KU_KATR3 string,
MCK_KU_ALIAS string,
XFD_KU_KATR2 string,
MCK_KU_PROMOIDS string,
MCK_KU_CALL_FREQ decimal(38,18),
MCK_KU_OTCDSMKUP decimal(38,18),
MCK_KU_EDI_BILLTYP string,
MCK_KU_RXDSMKUP decimal(38,18),
MCK_KU_NPI string,
MCK_KU_OTC_RTL_LBL_CONST2 string,
MCK_KU_OTC_PROMO_BILL_PLN string,
MCK_KU_SUB_CHAR6 string,
MCK_KU_RX_PROMO_BILL_PLN string,
MCK_KU_SUB_CHAR5 string,
MCK_KU_SHIP_METH string,
MCK_KU_SUB_CHAR4 string,
MCK_KU_RXPROMOMKUP decimal(38,18),
MCK_KU_SUB_CHAR3 string,
MCK_KU_OTC_RTL_LBL_CONST1 string,
MCK_KU_SUB_CHAR2 string,
MCK_KU_PRRTY string,
MCK_KU_SUB_CHAR1 string,
MCK_KU_SUB_CHAR9 string,
MCK_KU_SUB_CHAR0 string,
MCK_KU_SUB_CHAR8 string,
MCK_KU_DEA_SCNDRY string,
MCK_KU_OTCPROMOMKUP decimal(38,18),
MCK_KU_SUB_ADJ9 string,
MCK_KU_OTCMKUP decimal(38,18),
MCK_KU_RXMKUP decimal(38,18),
MCK_KU_OUTPUT_TYP string,
MCK_KU_EQUI_SER string,
MCK_KU_RQRMT decimal(38,18),
MCK_KU_EQUI_MDL string,
MCK_KU_SND_CNCL string,
MCK_KU_DELY_TAX_LOCN string,
MCK_KU_XCLD string,
MCK_KU_TRGT_FMT string,
MCK_KU_MANL string,
MCK_KU_TRGT_ID string,
MCK_KU_SLPS_TER_RSN string,
MCK_KU_TRGT_SYS string,
MCK_KU_SLPS_RX_OVR_IND string,
MCK_KU_SUB_CHAR7 string,
MCK_KU_CRD_RVW_DT string,
MCK_KU_DLOC_DCTYP string,
MCK_KU_DLOC_ALLOC_STAT string,
MCK_KU_CHNL_TYP string,
MCK_KU_DLOC_MRG_STAT string,
MCK_KU_GPO string,
MCK_KU_DLOC_FILENO string,
MCK_KU_SLPS_OTC_OVR_IND string,
MCK_KU_DLOC_CYCLNUM string,
MCK_KU_SLPS_CP string,
MCK_KU_RPTLEAD string,
MCK_KU_SLPS_MIN_QTY string,
XFD_KU_TRAIN_STN string,
MCK_KU_START_DT timestamp,
MCK_KU_DEA_EXPIR timestamp,
MCK_KU_VAR_PRC_REP string,
MCK_KU_CRD_LIMTOT_1 decimal(38,18),
MCK_KU_EFF_ENDDT timestamp,
MCK_KU_SLPS_L_STK string,
MCK_KU_ST_CS_LCNS string,
MCK_KU_SLPS_SS_CD string,
MCK_KU_ST_CS_LCNS_EXPIR timestamp,
MCK_KU_CNTRC_CBREFNUM string,
XFD_KU_CSOS_CK_ACTV string,
MCK_KU_CNTRC_VNDRNAM string,
MCK_KU_SLPS_LAYOUT string,
MCK_KU_CSMK_CHG decimal(38,18),
MCK_KU_AREARGN string,
MCK_KU_LCNS_TYP string,
MCK_KU_SLPS_L_TYP string,
MCK_KU_PRTNR string,
MCK_KU_SLPS_SS_OVR_IND string,
MCK_KU_CRD_LIMTOT_2 decimal(38,18),
MCK_KU_LCNS_TYP_DES string,
MCK_KU_DIST_CUST string,
MCK_KU_CUST_CR_RT string,
MCK_KU_E222_DEA_ASSN string,
MCK_KU_RAM string,
MCK_KU_DEA_CLS string,
MCK_KU_ACCT_STAT string,
MCK_KU_CUST_DUNS_RT string,
MCK_KU_CNTRC_COMM string,
MCK_KU_COLL_AGCY string,
MCK_KU_CNTRC_CDKEY string,
MCK_KU_CR_MGR string,
MCK_KU_RX_RSLTX decimal(38,18),
MCK_KU_CR_LIM_RVW_NEXT_YM decimal(38,18),
MCK_KU_ORD_CONFRM_PH decimal(38,18),
MCK_KU_RASR string,
MCK_KU_PROMOSTART timestamp,
MCK_KU_OPRGRP string,
MCK_KU_BNS_GOODS_QUAL string,
MCK_KU_CSMK_CD string,
MCK_KU_RXOTC_IND string,
MCK_KU_VAT_REG_NO_EXPIR timestamp,
MCK_KU_SLPS_RX_IND string,
MCK_KU_PCT_REBT decimal(38,18),
MCK_KU_SLPS_OTC_IND string,
MCK_KU_EDI_CORR_ID string,
MCK_KU_RPAR_CUST string,
MCK_KU_VNDR string,
MCK_KU_WHSLR string,
MCK_KU_CR_AUTH_TYP string,
MCK_KU_FUTR_OF_SCRPT string,
MCK_KU_CHN string,
MCK_KU_MRKT_CMPGN string,
MCK_KU_CHN_DUMMY string,
MCK_KU_NATL_GRP_DUMMY string,
MCK_KU_SUB_GRP_DUMMY string,
MCK_KU_CUST_RGN_DUMMY string,
MCK_KU_CUST_DSTRCT_DUMMY string,
MCK_KU_CHN_DUMMY_DESC string,
MCK_KU_NAT_GRP_DUMMY_DESC string,
MCK_KU_SUB_GRP_DUMMY_DESC string,
MCK_KU_CUST_RGN_DUMMY_DESC string,
MCK_KU_CUST_DIST_DUMMY_DESC string,
MCK_KU_CR_AUTH_REQ_FLG timestamp,
MCK_KU_CUST_LIST_NUM string,
MCK_KU_CUST_LIST_RQSTR string,
MCK_KU_CASH_DSCNT_FLG string,
MCK_KU_INTEREST_IND_TYP string,
MCK_KU_CR_MGR_USR_NAM string,
MCK_KU_CR_TERMS_PLASMA string,
MCK_KU_CASH_DSCNT_FLG_PLSM string,
MCK_KU_LATEPMT_PLASMA decimal(38,18),
MCK_KU_INVDISCD_PLASMA string,
MCK_KU_FORM_REQ_TYP string,
MCK_KU_EXPLANATION string,
MCK_KU_RX_HIER_OPT string,
MCK_KU_OTC_HIER_OPT string,
MCK_KU_COID string,
MCK_KU_CORRID string,
MCK_KU_EDIDOCTYP string,
MCK_KU_EDIPICKTYP string,
MCK_KU_GRPID string,
MCK_KU_PROMOID string,
MCK_KU_PROMOID_1 string,
MCK_KU_RMDY_REQ_NUM string,
MCK_KU_RMDY_RQSTR string,
MCK_KU_INVCPY_CTRLD decimal(38,18),
MCK_KU_CR_CUST string,
MCK_KU_EXT_ORDERING string,
MCK_KU_LYNX_PARENT_ACCOUNT string,
MCK_KU_DSCSA string,
MCK_KU_ACCT_CLAS string,
MCK_KU_ACCT_CLAS_DESC string,
MCK_KU_GPOS string,
MCK_KU_GPOS_DESC string,
MCK_KU_GPO_ACCT string,
MCK_KU_GOVT_CONTRACT_IND string,
Is_Active  boolean default TRUE,
  _rescued_data STRING,
  ADF_RUN_ID STRING COMMENT 'ID for specific pipeline run loaded from landing. This run_id gets generated when the records gets loaded from source to landing',
  ADF_JOB_ID STRING COMMENT 'ID of the trigger that invokes the pieline. This job_id gets generated when the records gets loaded from source to landing',
  RECORD_LOAD_TIME TIMESTAMP DEFAULT current_timestamp COMMENT 'This is the default generated column using current timestamp when the record is loaded in the table',
  INPUT_FILE_NAME STRING COMMENT 'File name which is getting populated from bronze layer',
  DATABRICKS_RUN_ID STRING COMMENT 'run id of the Databricks job run. This gets generated from the silver notebook run',
  DATABRICKS_JOB_ID STRING COMMENT 'job id of the Databricks job run. This gets generated from the silver notebook run',
  INSERT_TS TIMESTAMP COMMENT 'This is the default generated column using current timestamp when the record is loaded in the table',
  UPDATE_TS TIMESTAMP COMMENT 'This is the default generated column using current timestamp when the record is loaded in the table',
  DATE_PART DATE GENERATED ALWAYS AS (DATE(RECORD_LOAD_TIME)) COMMENT 'This the date part generated from Record load time column',
  HOUR_PART INT GENERATED ALWAYS AS (HOUR(RECORD_LOAD_TIME)) COMMENT 'This the hour part generated from Record load time column'
) USING DELTA PARTITIONED BY (DATE_PART, HOUR_PART) LOCATION '$$delta_table_location' 
TBLPROPERTIES (
  'delta.feature.allowColumnDefaults' = 'supported',
  'delta.feature.appendOnly' = 'supported',
  'delta.feature.invariants' = 'supported',
  'delta.minReaderVersion' = '1',
  'delta.minWriterVersion' = '7',
  'spark.sql.files.ignoreMissingFiles' = true
);
